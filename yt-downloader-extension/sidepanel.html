<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>YT Pro & Bilibili Panel</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --accent: #ff0033;
            --accent-bili: #00a1d6; /* M√†u xanh Bilibili */
            --text-main: #e0e0e0;
            --text-sub: #a0a0a0;
            --border: #333333;
            --success: #00e676;
            --error: #ff1744;
        }
        body {
            margin: 0; padding: 16px;
            background-color: var(--bg-color); color: var(--text-main);
            font-family: 'Segoe UI', Roboto, sans-serif; font-size: 13px;
            min-height: 100vh; display: flex; flex-direction: column;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-color); }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .brand { font-weight: 800; font-size: 18px; color: var(--accent); }
        .server-status { font-size: 11px; padding: 4px 10px; border-radius: 12px; background: #2a2a2a; display: flex; align-items: center; gap: 6px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; background: #666; }
        .dot.active { background: var(--success); box-shadow: 0 0 6px var(--success); }
        .dot.error { background: var(--error); }

        .tabs { display: flex; background: var(--card-bg); border-radius: 8px; padding: 4px; margin-bottom: 12px; overflow-x: auto;}
        .tab-btn { flex: 1; background: none; border: none; color: var(--text-sub); padding: 8px; cursor: pointer; border-radius: 6px; font-weight: 600; transition: 0.2s; white-space: nowrap; }
        .tab-btn.active { background: var(--border); color: #fff; }
        .tab-btn.bili-tab.active { color: var(--accent-bili); } /* Highlight tab bili */

        .section { background: var(--card-bg); border-radius: 10px; padding: 12px; margin-bottom: 10px; border: 1px solid var(--border); }
        
        /* Video Single UI */
        .video-preview { display: flex; flex-direction: column; gap: 8px; }
        .thumb { width: 100%; height: auto; aspect-ratio: 16/9; object-fit: cover; border-radius: 6px; background: #000; }
        .vid-title { font-weight: 600; margin-bottom: 2px; }
        .vid-url { font-size: 10px; color: var(--text-sub); word-break: break-all; }

        /* Queue UI */
        textarea {
            width: 100%; height: 100px;
            background: #2a2a2a; border: 1px solid var(--border);
            color: #fff; padding: 8px; border-radius: 6px;
            resize: vertical; font-family: monospace; font-size: 11px;
            box-sizing: border-box; outline: none;
        }
        .queue-status { font-size: 11px; color: #ffd700; margin-top: 5px; font-weight: 600; }

        /* General Inputs */
        .row { display: flex; gap: 10px; margin-bottom: 8px; }
        .col { flex: 1; }
        label { display: block; font-size: 11px; color: var(--text-sub); margin-bottom: 4px; }
        select, input[type="text"] { width: 100%; background: #2a2a2a; border: 1px solid var(--border); color: white; padding: 8px; border-radius: 6px; font-size: 12px; box-sizing: border-box; outline: none; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .chk-wrap { display: flex; align-items: center; gap: 6px; cursor: pointer; user-select: none; font-size: 12px;}
        .chk-wrap input { accent-color: var(--accent); }

        .path-group { display: flex; gap: 6px; margin-top: 5px; }
        .path-display { flex: 1; background: #2a2a2a; padding: 6px 10px; border-radius: 6px; font-size: 11px; color: var(--text-sub); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; line-height: 18px; }
        .btn-mini { background: #333; border: none; color: white; border-radius: 6px; cursor: pointer; padding: 0 10px; }

        .trim-box { margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--border); display: none; }
        .time-inputs { display: flex; gap: 8px; align-items: center; }

        .btn-main { width: 100%; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px; font-weight: 700; font-size: 14px; cursor: pointer; text-transform: uppercase; margin-bottom: 10px; transition: background 0.3s;}
        .btn-main:disabled { background: #333; color: #666; cursor: not-allowed; }
        
        /* Bilibili Button Style */
        .btn-bili { background: var(--accent-bili); }

        .btn-stop { background: var(--bg-color); border: 1px solid var(--error); color: var(--error); display: none; }

        .progress-wrap { margin-bottom: 15px; display: none; background: #252525; padding: 10px; border-radius: 8px; border: 1px solid #333; }
        .progress-meta { display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 6px; color: var(--text-sub); }
        .bar-bg { height: 8px; background: #333; border-radius: 4px; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; background: var(--success); transition: width 0.3s; }
        .status-msg { text-align: center; font-size: 11px; margin-top: 6px; color: #ddd; }

        .log-container { flex: 1; background: #000; border: 1px solid #333; border-radius: 6px; padding: 8px; font-family: 'Consolas', monospace; font-size: 11px; color: #00e676; overflow-y: auto; max-height: 200px; display: flex; flex-direction: column-reverse; }
        .log-line { margin-bottom: 2px; border-bottom: 1px solid #1a1a1a; padding-bottom: 2px; }

        .footer { text-align: center; margin-top: 10px; font-size: 10px; color: #444; }
        
        /* Bili Style Extras */
        .bili-note { font-size: 10px; color: #00a1d6; margin-top: 4px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="brand">‚ö° YT & BILI PRO</div>
        <div class="server-status">
            <div class="dot" id="statusDot"></div>
            <span id="statusText">Connecting...</span>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" data-tab="single">YouTube</button>
        <button class="tab-btn" data-tab="queue">YT Queue</button>
        <button class="tab-btn" data-tab="batch">YT Playlist</button>
        <button class="tab-btn bili-tab" data-tab="bilibili">Bilibili</button>
    </div>

    <div id="input-container">
        
        <div id="tab-single" class="tab-content">
            <div class="section">
                <div class="video-preview">
                    <img id="thumbImg" class="thumb" src="icon.png"> 
                    <div class="vid-info">
                        <div id="vidTitle" class="vid-title">ƒêang l·∫•y th√¥ng tin...</div>
                        <div id="vidUrl" class="vid-url">...</div>
                    </div>
                </div>
                <button id="btnRefreshTab" class="btn-mini" style="width:100%; margin-top:8px;">üîÑ C·∫≠p nh·∫≠t Video hi·ªán t·∫°i</button>
            </div>
        </div>

        <div id="tab-queue" class="tab-content" style="display:none;">
            <div class="section">
                <label>D√°n danh s√°ch link YT (M·ªói link 1 d√≤ng):</label>
                <textarea id="txtMultiLinks" placeholder="https://youtube.com/watch?v=...\nhttps://youtube.com/watch?v=..."></textarea>
                <div id="queueStatus" class="queue-status" style="display:none;"></div>
            </div>
        </div>

        <div id="tab-batch" class="tab-content" style="display:none;">
            <div class="section">
                <label>URL Playlist / Channel:</label>
                <input type="text" id="batchUrl" placeholder="Link Playlist...">
                <div style="margin-top:8px; display:flex; gap:15px;">
                    <label class="chk-wrap"><input type="checkbox" id="chkShorts" checked> Shorts</label>
                    <label class="chk-wrap"><input type="checkbox" id="chkLongs" checked> Video d√†i</label>
                </div>
            </div>
        </div>

        <div id="tab-bilibili" class="tab-content" style="display:none;">
            <div class="section" style="border-color: #00a1d6;">
                <label style="color: #00a1d6; font-weight:bold;">Bilibili Video URL:</label>
                <input type="text" id="biliUrl" placeholder="https://www.bilibili.com/video/BV...">
                <div class="bili-note">‚ö†Ô∏è D√πng BBDown Core. H·ªó tr·ª£ 1080P/4K (tu·ª≥ video). Kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p (Basic).</div>
            </div>
        </div>

        <div id="common-options" class="section">
            <div class="row">
                <div class="col">
                    <label>ƒê·ªãnh d·∫°ng</label>
                    <select id="selType">
                        <option value="video_audio">üé¨ Video + Ti·∫øng</option>
                        <option value="audio">üéµ Ch·ªâ Audio (MP3)</option>
                        <option value="video_only">üîá Ch·ªâ H√¨nh</option>
                    </select>
                </div>
                <div class="col">
                    <label>Ch·∫•t l∆∞·ª£ng</label>
                    <select id="selQuality">
                        <option value="best" selected>üöÄ Max (4K/8K)</option>
                        <option value="1080">üì∫ Full HD</option>
                        <option value="720">üì± HD 720p</option>
                    </select>
                </div>
            </div>
            
            <div class="options-grid">
                <label class="chk-wrap"><input type="checkbox" id="chkThumb"> üìÅ Folder+Img</label>
                <label class="chk-wrap"><input type="checkbox" id="chkTrim"> ‚úÇÔ∏è C·∫Øt Video</label>
            </div>

            <div class="trim-box" id="trimArea">
                <div class="time-inputs">
                    <input type="text" id="timeStart" placeholder="00:00:00" style="text-align:center">
                    <span>‚ûù</span>
                    <input type="text" id="timeEnd" placeholder="00:05:00" style="text-align:center">
                </div>
            </div>
        </div>

        <div class="section">
            <label>N∆°i l∆∞u tr·ªØ:</label>
            <div class="path-group">
                <div class="path-display" id="pathTxt">ƒêang t·∫£i...</div>
                <button class="btn-mini" id="btnChangePath">S·ª≠a</button>
            </div>
        </div>
    </div>

    <button id="btnDownload" class="btn-main" disabled>ƒêang t√¨m Server...</button>
    <button id="btnStop" class="btn-main btn-stop">‚õî D·ª™NG T·∫¢I</button>
    <button id="btnNewTask" class="btn-main" style="background:#444; display:none;">‚ûï T·∫¢I TI·∫æP</button>
    
    <div class="progress-wrap" id="progArea">
        <div class="progress-meta">
            <span id="progSpeed">0 MB/s</span>
            <span id="progEta">--:--</span>
        </div>
        <div class="bar-bg"><div class="bar-fill" id="progBar"></div></div>
        <div class="status-msg" id="progStat">ƒêang kh·ªüi t·∫°o...</div>
    </div>

    <label style="margin-left:4px;">üìú Logs h·ªá th·ªëng:</label>
    <div class="log-container" id="logBox">
        <div class="log-line">Waiting for logs...</div>
    </div>

    <div class="footer">YT Pro V9.8.0 - Bilibili Support</div>

    <script src="sidepanel.js"></script>
</body>
</html>